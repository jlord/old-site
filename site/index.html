<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="jlord">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>jlord</title>
    <link rel="shortcut icon" href="assets/favicon.png">
    <link href='http://fonts.googleapis.com/css?family=Playfair+Display:400,900,400italic,700italic|Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link href='assets/style.css' rel='stylesheet'>
  </head>
  <body>
    <div class="main-container">
      <header>
	<div class="row">
	  <div class="float-box lower-italic">
	    <a href="/">jlord</a>
	  </div>
	  <div class="float-box upper-bold-italic">
	    <a href="/blog">POSTS</a>
	  </div>
	</div>
	<div class="row">
	  <div class="float-box upper-bold-italic">
	    <a href="/work.html">WORK</a>
	  </div>
	  <div class="float-box lower-italic">
	    <a href="/about.html">about</a>
	</div>
</header>

      <div id="content">
      <div class="whole latest-post" style="border: none;">
        <h3>Sheetsee.js v3.0<h3>
        <div class="latest-post-content">
        <div class='post-header'><a href='sheetsee-3.html'><h1>Sheetsee.js v3.0</h1></a><ul><li>By Jessica Lord </li> <li>2014-02-28</li> <li>Open Source, Sheetsee.js</li></ul></div><p><img src="http://jlord.s3.amazonaws.com/wp-content/uploads/pennyzoom.png" alt="penny"></p>
<p>I&#39;ve just updated <a href="http://www.github.com/jlord/sheetsee.js">Sheetsee.js</a> with new features and all new docs. I&#39;ve been waiting to ship this, it feels like, for far too long. I&#8217;m hoping now Sheetsee is at a solid enough place that I can focus spare time on making more <a href="http://www.jlord.us/fork-n-go">fork-n-go</a> examples.</p>
<p>I&#39;ll get straight to the most exciting point: the new <a href="https://docs.google.com/spreadsheet/ccc?key=0Ao5u1U6KYND7dGN5QngweVJUWE16bTRob0d2a3dCbnc&amp;usp=drive_web&amp;pli=1#gid=0">sample data</a> for the demos is of my <a href="http://www.flickr.com/photos/jessllord/sets/72157640471928365/">flattened penny collection</a>. Below are the other things.</p>
<h3 id="new-features">New Features</h3>
<p>Yay!</p>
<h4 id="tables-pagination-multi-table-sorting-and-filtering">Tables: Pagination, Multi Table Sorting and Filtering</h4>
<p>Tables can now be paginated so that you don&#8217;t have to display your entire spreadsheet of data in one go. Unless you want to.</p>
<p>Tables now supports having multiple tables with sorting and filtering. So long as you keep your table IDs straight, you&#8217;re golden.</p>
See: <a href="http://jlord.github.io/sheetsee.js/demos/demo-table.html">table demo</a></p>
<h4 id="maps-polygons-and-lines">Maps: Polygons and Lines</h4>
<p>Maps now support polygons and lines. So long as you have the correct coordinate structure in your cells, Sheetsee will add them to the geoJSON it creates for your maps. More details for coordinates of lines and polygons in geoJSON are <a href="http://leafletjs.com/examples/geojson.html">here</a>, but briefly:</p>
<p>A linestring:</p>
<pre><code>[-122.41722106933594, 37.7663045891584], [-122.40477561950684, 37.77695634643178]</code></pre>
<p>A polygon:</p>
<pre><code>[-122.41790771484375, 37.740381166384914], [-122.41790771484375, 37.74520008134973], [-122.40966796874999, 37.74520008134973],[-122.40966796874999, 37.740381166384914], [-122.41790771484375, 37.740381166384914]</code></pre>
<p>A Multipolygon:</p>
<pre><code>[[-122.431640625, 37.79106586542567], [-122.431640625, 37.797441398913286], [-122.42666244506835, 37.797441398913286],[-122.42666244506835, 37.79106586542567], [-122.431640625, 37.79106586542567]],
[[-122.43352890014648, 37.78197638783258], [-122.43352890014648, 37.789031004883654], [-122.42443084716797, 37.789031004883654], [-122.42443084716797, 37.78197638783258], [-122.43352890014648, 37.78197638783258]]</code></pre>
<p>See: <a href="http://jlord.github.io/sheetsee.js/demos/demo-map.html">map demo</a>.</p>
<h3 id="documentation">Documentation</h3>
<p>I redid the documentation and website for Sheetsee. Instead of one <em>gigantic</em> readme file/website, all of the different elements are given their own file/page. Now you can find docs, demos, tips and such all filed away nicely here in the <a href="http://www.github.com/jlord/sheetsee.js">repository</a> and on the <a href="http://jlord.github.io/sheetsee.js">website</a>.</p>
<h3 id="modules">Modules</h3>
<p>The other big thing that has happened to Sheetsee is that I&#39;ve taken each component (core, maps, tables and charts) and made them into their own Node.js module. This makes for smaller, more manageable code files and it makes it so that users can build their own version of Sheetsee with just the elements they want to use. For instance, if you&#39;re only making maps, just build a Sheetsee with the map component.</p>
<p>All builds come with the <code>sheetsee-core</code> module which contains all of the data organizing functions.</p>
<p>The module <code>sheetsee</code> is a command line module that builds your custom sheetsee for you.</p>
<p>If you&#39;re not interested in Node modules or building anything, that&#39;s ok, too. I&#39;ll always keep a full build (with all the components) here in <a href="https://github.com/jlord/sheetsee.js/tree/master/js">the sheetsee.js repository</a> (which from here on out exists to be the consolidated documentation and source of a full build).</p>
<p>If you need to file an issue for a bug or feature, try and file it on the repository with the component it relates to (they each have their own repository now):</p>
<ul>
<li><a href="http://www.github.com/jlord/sheetsee-maps">sheetsee-maps</a></li>
<li><a href="http://www.github.com/jlord/sheetsee-tables">sheetsee-tables</a></li>
<li><a href="http://www.github.com/jlord/sheetsee-charts">sheetsee-charts</a></li>
<li><a href="http://www.github.com/jlord/sheetsee-core">sheetsee-core</a></li>
<li><a href="http://www.github.com/jlord/sheetsee">sheetsee</a></li>
</ul>

        </div>
      </div>
      <div class="whole">
        <h2>Instagram<h2>
          <div id="instagram"><span class="load flash animated">LOADING...</span></div>
          <div style="display: block;"></div>
      </div>

      <div class="whole">
        <h2>Twitter</h2>
        <div id="tweet"><span class="load flash animated">LOADING...</span></div>
      </div>

      <div class="whole">
        <div class="half">
          <h2>Highlight</h2>
          <div id="quote"><span class="load flash animated">LOADING...</span></div>
        </div>

        <div class="half">
          <h2>Instapaper</h2>
          <div id="pocket"><span class="load flash animated">LOADING...</span></div>
        </div>
        </div>

        <div class="whole">
          <div class="half">
            <h3>Me</h3>
            <p>My heart is in the open web, knowledge sharing, javascript and node.</p> 
            <p>I live in Oakland, Ca and work at <a href="">GitHub</a>.</p>
            <span class="meta"><a href="about.html">More details</a></span>
          </div>
          <div class="half">
            <h3>Site</h3>
            <p>Lovingly and frustratingly made by me, including my own <a href="http://github.com/jlord/balrog" target=" _blank">static site generator</a> (don't even get me started). Go ahead, <a href="">view source</a>, see the complete <a href="">code on GitHub</a> or checkout the <a href="">blog</a> for posts related to specific bits.</p>
          </div>
        </div>

      <script type="text/javascript" src="assets/js/sheetsee.js"></script>
      <script type="text/javascript" src="assets/js/handlebars.js"></script>
      <script type="text/javascript" src="assets/js/tabletop1.3.3.js"></script>
      <script type="text/javascript" src="assets/js/templates.js"></script>

      <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
          var URL  = '0Ao5u1U6KYND7dG9CRWdjeVB6dGYyN3c3RktocExUV1E' // insta
          var URL2 = '0Ao5u1U6KYND7dDd2RTBwajZrT3pEc2p2LVVWc0o0WVE' // tweet
          var URL3 = '0Ao5u1U6KYND7dFR4aDRFb1RsZmlHRXc3ZnFHa3ltTXc' // quotes
          var URL4 = '0Ao5u1U6KYND7dFM4R1RKSUNZSXdNbkhpRUVZZ3pRTEE' // pocket
          Tabletop.init({ key: URL,  callback: buildInsta,  simpleSheet: true })
          Tabletop.init({ key: URL2, callback: buildTweet,  simpleSheet: true })
          Tabletop.init({ key: URL3, callback: buildQuote,  simpleSheet: true })
          Tabletop.init({ key: URL4, callback: buildPocket, simpleSheet: true })
        })

        function buildInsta(data) {
          var compiledTemplate = Handlebars.templates['instagram']
          var html = compiledTemplate({"rows": getLast(data,3)}, {});
          document.getElementById('instagram').innerHTML = html
        }

        function buildTweet(data) {
          var lastTweet = data[data.length - 1]
          var date = lastTweet.date
          var parsedTweet = {
            'tweet': findLinks(lastTweet), 
            'date': date }
          var template = Handlebars.templates['twitter']
          var html = template({"rows": parsedTweet}, {});
          document.getElementById('tweet').innerHTML = html
        }

        function buildQuote(data) {
          var template = Handlebars.templates['quote']
          var html = template({"rows": data.reverse()[0]}, {});
          document.getElementById('quote').innerHTML = html
        }

        function buildPocket(data) {
          var template = Handlebars.templates['pocket']
          var html = template({"rows": getLast(data,2)}, {});
          document.getElementById('pocket').innerHTML = html
        }

        function getLast(array, howMany) {
          start = array.length
          cut = start - howMany
          if (start < 12) {
          return array
          } else {
            array = array.splice(cut)
            return array.reverse()
          }
        }

        // parse tweets 
        // move to sep. file

        function findLinks(tweet) {
          if (!tweet.tweet) return
          var linkPattern = /(^|\s)((https?:\/\/)?[\w-]+(\.[\w-]+)+\.?(:\d+)?(\/\S*)?)/gi
           
            if (!tweet.tweet.match(linkPattern)) {
              return tweetMentions(tweet.tweet)
            } else {
              var links = tweet.tweet.match(linkPattern)
              var linkLinks = linkLink(links)
              var newTweet = injectLinks(tweet.tweet, links, linkLinks)
              return tweetMentions(newTweet)
            }       
        }

        function tweetMentions(tweet, date) {
          if (!tweet) return
          var mentionPattern = /\B@[a-z0-9_-]+/gi
          
          if (tweet.match(mentionPattern)) {
            var mentions = tweet.match(mentionPattern)
            var linkMentions = linkMention(mentions)
            var newTweet = injectLinks(tweet, mentions, linkMentions)
            return newTweet
          } else { return tweet }
        }
        
        function linkMention(mentions) {
          if (!mentions) return
          var linkMentions = []
          mentions.forEach(function(mention){
            var wrap = "<a href='http://www.twittter.com/" + mention + "' target='_blank'>" + mention + "</a>"
            linkMentions.push(wrap)
          })
          return linkMentions
        }
        
        function linkLink(links) {
          if (!links) return
          var linkLinks = []
          links.forEach(function(link) {
            link = '<a href="' + link + '" target="_blank">' + link + '</a>'
            linkLinks.push(link)
          })
          return linkLinks
        }
        
        function injectLinks(tweet, mentions, linkMentions) {
          for (var i = 0; i <= mentions.length; i++) {
            tweet = tweet.replace(mentions[i], linkMentions[i])
            if (i === mentions.length) return tweet
          }    
        }
      </script>
      </div>

      <footer>
  <ul>
    <li><a href="rss.xml">RSS</a></li>
    <li><a href="/blog">Posts</a></li>
  </ul>
  <ul>
    <li><a href="/work.html">Work</a></li>
    <li><a href="/about.html">About</a></li>
  </ul>
  <ul>
    <li><a href="http://www.twitter.com/jllord" target="_blank">@jllord</a></li>
    <li><a href="http://www.github.com/jlord" target="_blank">gh/jlord</a></li>
  </ul>
  <ul>
    <li><a href="/blog/archive.html">Archive</a></li>
    <li><a href="/" class="green"><strong>Home</strong></a></li>
  </ul>
</footer>
    </div>
  </body>
</html>
